--- Makefile_dll.orig	2023-02-27 04:22:36.538721506 +0100
+++ Makefile_dll	2023-02-27 04:45:45.697393811 +0100
@@ -5,21 +5,25 @@
 
 WORKDIR = `pwd`
 
-CC = gcc
-CXX = g++
-AR = ar
-LD = g++
+COMPILER_PREFIX = i686-w64-mingw32-
+
+CC = $(COMPILER_PREFIX)gcc
+CXX = $(COMPILER_PREFIX)g++
+AR = $(COMPILER_PREFIX)ar
+LD = $(COMPILER_PREFIX)g++
 WINDRES = windres
 
 INC = 
-CFLAGS = -std=c++11 -march=i686 -mtune=generic -pedantic -Wall -Wextra -Wshadow -Wundef -Wuseless-cast -Wpointer-arith -Wfloat-conversion
+CCFLAGS = -march=i686 -mtune=generic -pedantic -Wall -Wextra -Wshadow -Wundef -Wpointer-arith -Wfloat-conversion
+CFLAGS = $(CCFLAGS) -std=c++11 -Wuseless-cast
 RESINC = 
 LIBDIR = 
 LIB = -luser32 -lwinmm -lgdi32 -lpsapi
-LDFLAGS = 
+LDFLAGS = -static-libgcc -static-libstdc++ -static
 
 INC_DEBUG = $(INC)
 CFLAGS_DEBUG = $(CFLAGS) -g -Og -DBUILD_DLL -DBUILD_DEBUG
+CCFLAGS_DEBUG = $(CCFLAGS) -g -Og -DBUILD_DLL -DBUILD_DEBUG
 RESINC_DEBUG = $(RESINC)
 RCFLAGS_DEBUG = $(RCFLAGS)
 LIBDIR_DEBUG = $(LIBDIR)
@@ -27,10 +31,11 @@
 LDFLAGS_DEBUG = $(LDFLAGS)
 OBJDIR_DEBUG = build/obj/debug
 DEP_DEBUG = 
-OUT_DEBUG = build/bin/debug/thinker.so
+OUT_DEBUG = build/bin/debug/thinker.dll
 
 INC_DEVELOP = $(INC)
 CFLAGS_DEVELOP = $(CFLAGS) -O2 -fno-common -fno-strict-aliasing -fno-delete-null-pointer-checks -fno-optimize-sibling-calls -DBUILD_DLL
+CCFLAGS_DEVELOP = $(CCFLAGS) -O2 -fno-common -fno-strict-aliasing -fno-delete-null-pointer-checks -fno-optimize-sibling-calls -DBUILD_DLL
 RESINC_DEVELOP = $(RESINC)
 RCFLAGS_DEVELOP = $(RCFLAGS)
 LIBDIR_DEVELOP = $(LIBDIR)
@@ -38,10 +43,11 @@
 LDFLAGS_DEVELOP = $(LDFLAGS) -s -static
 OBJDIR_DEVELOP = build/obj/develop
 DEP_DEVELOP = 
-OUT_DEVELOP = build/bin/develop/thinker.so
+OUT_DEVELOP = build/bin/develop/thinker.dll
 
 INC_RELEASE = $(INC)
 CFLAGS_RELEASE = $(CFLAGS) -O2 -fno-common -fno-strict-aliasing -fno-delete-null-pointer-checks -fno-optimize-sibling-calls -DBUILD_DLL -DBUILD_REL
+CCFLAGS_RELEASE = $(CCFLAGS) -O2 -fno-common -fno-strict-aliasing -fno-delete-null-pointer-checks -fno-optimize-sibling-calls -DBUILD_DLL -DBUILD_REL
 RESINC_RELEASE = $(RESINC)
 RCFLAGS_RELEASE = $(RCFLAGS)
 LIBDIR_RELEASE = $(LIBDIR)
@@ -49,7 +55,7 @@
 LDFLAGS_RELEASE = $(LDFLAGS) -s -static
 OBJDIR_RELEASE = build/obj/release
 DEP_RELEASE = 
-OUT_RELEASE = build/bin/release/thinker.so
+OUT_RELEASE = build/bin/release/thinker.dll
 
 OBJ_DEBUG = $(OBJDIR_DEBUG)/src/random.o $(OBJDIR_DEBUG)/src/move.o $(OBJDIR_DEBUG)/src/patch.o $(OBJDIR_DEBUG)/src/path.o $(OBJDIR_DEBUG)/src/plan.o $(OBJDIR_DEBUG)/src/tech.o $(OBJDIR_DEBUG)/src/test.o $(OBJDIR_DEBUG)/src/turn.o $(OBJDIR_DEBUG)/src/veh.o $(OBJDIR_DEBUG)/src/game.o $(OBJDIR_DEBUG)/src/debug.o $(OBJDIR_DEBUG)/src/engine.o $(OBJDIR_DEBUG)/src/base.o $(OBJDIR_DEBUG)/src/gui.o $(OBJDIR_DEBUG)/src/lib/ini.o $(OBJDIR_DEBUG)/src/main.o $(OBJDIR_DEBUG)/src/map.o
 
@@ -64,7 +70,6 @@
 before_build: 
 
 after_build: 
-	cmd /c copy "$(PROJECT_DIR)$(TARGET_OUTPUT_FILE)" patch\
 
 before_debug: 
 	test -d build/bin/debug || mkdir -p build/bin/debug
@@ -123,7 +128,7 @@
 	$(CXX) $(CFLAGS_DEBUG) $(INC_DEBUG) -c src/gui.cpp -o $(OBJDIR_DEBUG)/src/gui.o
 
 $(OBJDIR_DEBUG)/src/lib/ini.o: src/lib/ini.c
-	$(CPP) $(CFLAGS_DEBUG) $(INC_DEBUG) -c src/lib/ini.c -o $(OBJDIR_DEBUG)/src/lib/ini.o
+	$(CC) $(CCFLAGS_DEBUG) $(INC_DEBUG) -c src/lib/ini.c -o $(OBJDIR_DEBUG)/src/lib/ini.o
 
 $(OBJDIR_DEBUG)/src/main.o: src/main.cpp
 	$(CXX) $(CFLAGS_DEBUG) $(INC_DEBUG) -c src/main.cpp -o $(OBJDIR_DEBUG)/src/main.o
@@ -194,7 +199,7 @@
 	$(CXX) $(CFLAGS_DEVELOP) $(INC_DEVELOP) -c src/gui.cpp -o $(OBJDIR_DEVELOP)/src/gui.o
 
 $(OBJDIR_DEVELOP)/src/lib/ini.o: src/lib/ini.c
-	$(CPP) $(CFLAGS_DEVELOP) $(INC_DEVELOP) -c src/lib/ini.c -o $(OBJDIR_DEVELOP)/src/lib/ini.o
+	$(CC) $(CCFLAGS_DEVELOP) $(INC_DEVELOP) -c src/lib/ini.c -o $(OBJDIR_DEVELOP)/src/lib/ini.o
 
 $(OBJDIR_DEVELOP)/src/main.o: src/main.cpp
 	$(CXX) $(CFLAGS_DEVELOP) $(INC_DEVELOP) -c src/main.cpp -o $(OBJDIR_DEVELOP)/src/main.o
@@ -265,8 +270,7 @@
 	$(CXX) $(CFLAGS_RELEASE) $(INC_RELEASE) -c src/gui.cpp -o $(OBJDIR_RELEASE)/src/gui.o
 
 $(OBJDIR_RELEASE)/src/lib/ini.o: src/lib/ini.c
-	$(CPP) $(CFLAGS_RELEASE) $(INC_RELEASE) -c src/lib/ini.c -o $(OBJDIR_RELEASE)/src/lib/ini.o
-
+	$(CC) $(CCFLAGS_RELEASE) $(INC_RELEASE) -c src/lib/ini.c -o $(OBJDIR_RELEASE)/src/lib/ini.o
 $(OBJDIR_RELEASE)/src/main.o: src/main.cpp
 	$(CXX) $(CFLAGS_RELEASE) $(INC_RELEASE) -c src/main.cpp -o $(OBJDIR_RELEASE)/src/main.o
 
